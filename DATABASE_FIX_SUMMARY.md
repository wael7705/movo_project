# ููุฎุต ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช - ูุธุงู ุงูุทูุจุงุช

## ๐ฏ ุงููุดููุฉ ุงูุฃุตููุฉ
ูุงู ููุงู ูุดููุชุงู ุฑุฆูุณูุชุงู:
1. **ุชุจููุจ "ูุนุงูุฌุฉ" ูุง ูุนุฑุถ ุงูุทูุจุงุช** - ุจุณุจุจ ุนุฏู ุชุทุงุจู `current_stage_name` ูุน ุงูููู ุงููุชููุนุฉ
2. **ุฎุทุฃ ูู enum** - `ERROR: invalid input value for enum order_status_enum: "preparing"`

## ๐ง ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. ุชุญุฏูุซ `order_status_enum`
ุชู ุชุญุฏูุซ `enum` ููุดูู ุฌููุน ุงูุญุงูุงุช ุงููุทููุจุฉ:
```sql
CREATE TYPE order_status_enum AS ENUM (
    'pending', 'choose_captain', 'processing', 'out_for_delivery', 
    'delivered', 'cancelled', 'problem', 'deferred', 'pickup'
);
```

### 2. ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจ
ุชู ุชุญุฏูุฏ ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจ ููุง ููู:
1. **pending** - ูู ุงูุงูุชุธุงุฑ
2. **choose_captain** - ุงุฎุชูุงุฑ ูุงุจุชู
3. **processing** - ูุนุงูุฌุฉ (ูุน 3 ูุฑุงุญู ูุฑุนูุฉ):
   - `waiting_approval` - ุงูุชุธุงุฑ ุงููุจูู ูู ุงููุทุนู
   - `preparing` - ุชุญุถูุฑ
   - `captain_received` - ุงุณุชูู ุงููุงุจุชู
4. **out_for_delivery** - ุฎุฑุฌ ููุชูุตูู
5. **delivered** - ุชู ุงูุชูุตูู

### 3. ุงูุญุงูุงุช ุงูุฅุถุงููุฉ
- **cancelled** - ููุบู
- **problem** - ูุดููุฉ
- **deferred** - ูุคุฌู (ูู ุฎูุงุฑุฒููุฉ ุฎุงุตุฉ)
- **pickup** - ุงุณุชูุงู ุดุฎุตู (ูู ุฎูุงุฑุฒููุฉ ูุฎุชููุฉ)

### 4. ุชุญุฏูุซ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
ุชู ุชุญุฏูุซ ุงููููุงุช ุงูุชุงููุฉ:
- `Dashboard.tsx` - ุฅุถุงูุฉ ุชุจููุจุงุช `deferred` ู `pickup`
- `AdminDashboard.tsx` - ุชุญุฏูุซ ุงูุชุจููุจุงุช
- `OrderCard.tsx` - ุฅุถุงูุฉ ุชุณููุงุช ูุฃููุงู ููุญุงูุงุช ุงูุฌุฏูุฏุฉ
- `api.ts` - ุชุญุฏูุซ mapping ููุญุงูุงุช
- `ordersApi.ts` - ุฅุถุงูุฉ ุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ

### 5. ุชุญุฏูุซ ุงูุจุงูููุฏ
ุชู ุชุญุฏูุซ ุงููููุงุช ุงูุชุงููุฉ:
- `core/status.py` - ุฅุถุงูุฉ ุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ ุฅูู `VALID`
- `api/routes/orders.py` - ุชุญุฏูุซ ููุทู `advance_order`
- `models/order.py` - ุชุญุฏูุซ ุชุนุฑูู `status` column

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### Enum ูุญุฏุซ
```sql
['pending', 'choose_captain', 'processing', 'out_for_delivery', 'delivered', 'cancelled', 'problem', 'deferred', 'pickup']
```

### ุงูุทูุจุงุช ูู ุชุจููุจ "ูุนุงูุฌุฉ"
- **waiting_approval**: 1 ุทูุจ
- **preparing**: 1 ุทูุจ  
- **captain_received**: 1 ุทูุจ

### ุงูุทูุจุงุช ูู ุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ
- **deferred**: 1 ุทูุจ
- **pickup**: 1 ุทูุจ

## ๐๏ธ ุงููููุงุช ุงููุณุชุฎุฏูุฉ ููุฅุตูุงุญ

### ููู ูุงุญุฏ ููุญุฏ
- `fix_database_unified.py` - ุณูุฑูุจุช Python ููุญุฏ ูุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `database.sql` - ููู SQL ุงูุฑุฆูุณู ูุน ุงูุฅุตูุงุญุงุช

## โ ุงูุชุญูู ูู ุงูุฅุตูุงุญ

ุชู ุงูุชุญูู ูู ุฃู:
1. โ `enum` ูุญุชูู ุนูู ุฌููุน ุงูููู ุงููุทููุจุฉ
2. โ ุงูุทูุจุงุช ุชุธูุฑ ูู ุชุจููุจ "ูุนุงูุฌุฉ" ูุน ุงููุฑุงุญู ุงููุฑุนูุฉ ุงูุตุญูุญุฉ
3. โ ุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ (`deferred`, `pickup`) ุชุนูู ุจุดูู ุตุญูุญ
4. โ ุฌููุน ุงูุชุจููุจุงุช ุชุนุฑุถ ุงูุทูุจุงุช ุงูููุงุณุจุฉ

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุงุฎุชุจุงุฑ ุงููุงุฌูุฉ** - ุชุฃูุฏ ูู ุฃู ุฌููุน ุงูุชุจููุจุงุช ุชุนูู ุจุดูู ุตุญูุญ
2. **ุงุฎุชุจุงุฑ ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจ** - ุชุฃูุฏ ูู ุงูุงูุชูุงู ุจูู ุงูุญุงูุงุช
3. **ุงุฎุชุจุงุฑ ุงูุฎูุงุฑุฒููุงุช ุงูุฎุงุตุฉ** - ููุญุงูุงุช `deferred` ู `pickup`

## ๐ ููุงุญุธุงุช ูููุฉ

- ุชู ุชูุญูุฏ ุฌููุน ุงูุฅุตูุงุญุงุช ูู ููู ูุงุญุฏ (`fix_database_unified.py`) ูููุน ุงูุชุดุชุช
- ุชู ุชุญุฏูุซ `database.sql` ููููู ุงููุตุฏุฑ ุงููุญูุฏ ููุญูููุฉ
- ุชู ุญุฐู ุฌููุน ุงููููุงุช ุงููุคูุชุฉ ูุงูุฅุตูุงุญุงุช ุงูููุฒุนุฉ
- ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ููุญุฏ ููุชุณู
